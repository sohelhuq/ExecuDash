{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the finance management system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user, typically the Firebase Auth UID."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "name": {
          "type": "string",
          "description": "The user's full name."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "The timestamp when the user account was created."
        }
      },
      "required": ["id", "email", "createdAt"]
    },
    "FinancialData": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "FinancialData",
      "type": "object",
      "description": "Represents a single financial transaction or record.",
      "properties": {
        "id": {
          "type": "string"
        },
        "userId": {
          "type": "string",
          "description": "The ID of the user this data belongs to."
        },
        "date": {
          "type": "string",
          "format": "date",
          "description": "The date of the transaction."
        },
        "description": {
          "type": "string",
          "description": "A description of the transaction."
        },
        "amount": {
          "type": "number",
          "description": "The transaction amount. Positive for income, negative for expenses."
        },
        "category": {
          "type": "string",
          "description": "The category of the transaction (e.g., 'Salary', 'Groceries', 'Utilities')."
        },
        "type": {
          "type": "string",
          "enum": ["income", "expense"],
          "description": "The type of transaction."
        }
      },
      "required": ["id", "userId", "date", "description", "amount", "category", "type"]
    },
    "TaxRecord": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TaxRecord",
      "type": "object",
      "description": "Represents a tax-related record or insight.",
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string" },
        "period": { "type": "string", "description": "The tax period, e.g., '2024-Q3'." },
        "taxableIncome": { "type": "number" },
        "deductions": { "type": "number" },
        "taxOwed": { "type": "number" },
        "status": { "type": "string", "enum": ["Pending", "Filed", "Paid"] },
        "aiInsight": { "type": "string", "description": "AI-generated insight for tax optimization." }
      },
      "required": ["id", "userId", "period", "taxableIncome", "status"]
    },
    "Goal": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Goal",
      "type": "object",
      "description": "Represents a user's financial goal.",
      "properties": {
        "id": { "type": "string" },
        "userId": { "type": "string" },
        "name": { "type": "string", "description": "The name of the goal." },
        "targetAmount": { "type": "number" },
        "currentAmount": { "type": "number" },
        "targetDate": { "type": "string", "format": "date" }
      },
      "required": ["id", "userId", "name", "targetAmount", "currentAmount"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": { "$ref": "#/entities/User" },
          "description": "Stores user profile information.",
          "params": [{ "name": "userId", "description": "The user's unique ID." }]
        }
      },
      {
        "path": "/users/{userId}/financial_data/{dataId}",
        "definition": {
          "entityName": "FinancialData",
          "schema": { "$ref": "#/entities/FinancialData" },
          "description": "Stores all financial transactions for a user.",
          "params": [
            { "name": "userId", "description": "The user's unique ID." },
            { "name": "dataId", "description": "The transaction's unique ID." }
          ]
        }
      },
      {
        "path": "/users/{userId}/tax_records/{recordId}",
        "definition": {
          "entityName": "TaxRecord",
          "schema": { "$ref": "#/entities/TaxRecord" },
          "description": "Stores tax records and AI insights for a user.",
          "params": [
            { "name": "userId", "description": "The user's unique ID." },
            { "name": "recordId", "description": "The tax record's unique ID." }
          ]
        }
      },
      {
        "path": "/users/{userId}/goals/{goalId}",
        "definition": {
          "entityName": "Goal",
          "schema": { "$ref": "#/entities/Goal" },
          "description": "Stores financial goals for a user.",
          "params": [
            { "name": "userId", "description": "The user's unique ID." },
            { "name": "goalId", "description": "The goal's unique ID." }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed around the user, with sub-collections for their financial data, tax records, and goals. This ensures strong data ownership and security, as rules can be easily applied to a user's entire data tree."
  }
}
